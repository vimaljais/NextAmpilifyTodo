{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// pages/index.js\nimport { AmplifyAuthenticator } from \"@aws-amplify/ui-react\";\nimport { Amplify, API, Auth, withSSRContext } from \"aws-amplify\";\nimport Head from \"next/head\";\nimport awsExports from \"../src/aws-exports\";\nimport { createPost } from \"../src/graphql/mutations\";\nimport { listPosts } from \"../src/graphql/queries\";\nimport styles from \"../styles/Home.module.css\";\nAmplify.configure(_objectSpread(_objectSpread({}, awsExports), {}, {\n  ssr: true\n}));\nexport async function getServerSideProps({\n  req\n}) {\n  const SSR = withSSRContext({\n    req\n  });\n  const response = await SSR.API.graphql({\n    query: listPosts\n  });\n  return {\n    props: {\n      posts: response.data.listPosts.items\n    }\n  };\n}\n\nasync function handleCreatePost(event) {\n  event.preventDefault();\n  const form = new FormData(event.target);\n\n  try {\n    const {\n      data\n    } = await API.graphql({\n      authMode: \"AMAZON_COGNITO_USER_POOLS\",\n      query: createPost,\n      variables: {\n        input: {\n          title: form.get(\"title\"),\n          content: form.get(\"content\")\n        }\n      }\n    });\n    window.location.href = `/posts/${data.createPost.id}`;\n  } catch ({\n    errors\n  }) {\n    console.error(...errors);\n    throw new Error(errors[0].message);\n  }\n}\n\nexport default function Home({\n  posts = []\n}) {\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: styles.container,\n    children: [/*#__PURE__*/_jsxs(Head, {\n      children: [/*#__PURE__*/_jsx(\"title\", {\n        children: \"Amplify + Next.js\"\n      }), /*#__PURE__*/_jsx(\"link\", {\n        rel: \"icon\",\n        href: \"/favicon.ico\"\n      })]\n    }), /*#__PURE__*/_jsxs(\"main\", {\n      className: styles.main,\n      children: [/*#__PURE__*/_jsx(\"h1\", {\n        className: styles.title,\n        children: \"Amplify + Next.js\"\n      }), /*#__PURE__*/_jsxs(\"p\", {\n        className: styles.description,\n        children: [/*#__PURE__*/_jsx(\"code\", {\n          className: styles.code,\n          children: posts.length\n        }), \"posts\"]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: styles.grid,\n        children: [posts.map(post => /*#__PURE__*/_jsxs(\"a\", {\n          className: styles.card,\n          href: `/posts/${post.id}`,\n          children: [/*#__PURE__*/_jsx(\"h3\", {\n            children: post.title\n          }), /*#__PURE__*/_jsx(\"p\", {\n            children: post.content\n          })]\n        }, post.id)), /*#__PURE__*/_jsxs(\"div\", {\n          className: styles.card,\n          children: [/*#__PURE__*/_jsx(\"h3\", {\n            className: styles.title,\n            children: \"New Post\"\n          }), /*#__PURE__*/_jsx(AmplifyAuthenticator, {\n            children: /*#__PURE__*/_jsxs(\"form\", {\n              onSubmit: handleCreatePost,\n              children: [/*#__PURE__*/_jsxs(\"fieldset\", {\n                children: [/*#__PURE__*/_jsx(\"legend\", {\n                  children: \"Title\"\n                }), /*#__PURE__*/_jsx(\"input\", {\n                  defaultValue: `Today, ${new Date().toLocaleTimeString()}`,\n                  name: \"title\"\n                })]\n              }), /*#__PURE__*/_jsxs(\"fieldset\", {\n                children: [/*#__PURE__*/_jsx(\"legend\", {\n                  children: \"Content\"\n                }), /*#__PURE__*/_jsx(\"textarea\", {\n                  defaultValue: \"I built an Amplify app with Next.js!\",\n                  name: \"content\"\n                })]\n              }), /*#__PURE__*/_jsx(\"button\", {\n                children: \"Create Post\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                type: \"button\",\n                onClick: () => Auth.signOut(),\n                children: \"Sign out\"\n              })]\n            })\n          })]\n        })]\n      })]\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}